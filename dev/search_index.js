var documenterSearchIndex = {"docs":
[{"location":"#Mongoc.jl-1","page":"Home","title":"Mongoc.jl","text":"","category":"section"},{"location":"#Introduction-1","page":"Home","title":"Introduction","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Mongoc.jl is a MongoDB driver for the Julia Language.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"It is implemented as a thin wrapper around libmongoc, the official client library for C applications.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"Given that BSON is the document format for MongoDB, this package also implements a wrapper around libbson, which provides a way to create and manipulate BSON documents.","category":"page"},{"location":"#Requirements-1","page":"Home","title":"Requirements","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"MongoDB 3.0 or newer.\nJulia versions v1.0 or newer.\nLinux, macOS\nWindows (experimental).","category":"page"},{"location":"#Installation-1","page":"Home","title":"Installation","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"From a Julia session, run:","category":"page"},{"location":"#","page":"Home","title":"Home","text":"julia> using Pkg\n\njulia> Pkg.add(\"Mongoc\")","category":"page"},{"location":"#MongoDB-C-Driver-1","page":"Home","title":"MongoDB C Driver","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"This packages downloads precompiled binaries for MongoDB C Driver from mongo-c-driver-builder.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"The binaries are compiled by Travis CI, using BinaryBuilder.jl.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"Windows is currently not supported.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"If your platform is not supported and can be compiled by BinaryBuilder.jl, please open an issue.","category":"page"},{"location":"#Source-Code-1","page":"Home","title":"Source Code","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"The source code for this package is hosted at https://github.com/felipenoris/Mongoc.jl.","category":"page"},{"location":"#License-1","page":"Home","title":"License","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"The source code for the package Mongoc.jl is licensed under the MIT License.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"This repository distributes binary assets built from mongo-c-driver source code, which is licensed under Apache-2.0.","category":"page"},{"location":"#Getting-Help-1","page":"Home","title":"Getting Help","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"If you're having any trouble, have any questions about this package or want to ask for a new feature, just open a new issue.","category":"page"},{"location":"#Contributing-1","page":"Home","title":"Contributing","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Contributions are always welcome!","category":"page"},{"location":"#","page":"Home","title":"Home","text":"To contribute, fork the project on GitHub and send a Pull Request.","category":"page"},{"location":"#References-1","page":"Home","title":"References","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"libbson documentation\nlibmongoc documentation","category":"page"},{"location":"tutorial/#Tutorial-1","page":"Tutorial","title":"Tutorial","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"This tutorial illustrates common use cases for accessing a MongoDB database with Mongoc.jl package.","category":"page"},{"location":"tutorial/#Setup-1","page":"Tutorial","title":"Setup","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"First, make sure you have Mongoc.jl package installed.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> using Pkg\n\njulia> Pkg.add(\"Mongoc\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"The following tutorial assumes that a MongoDB instance is running on the default host and port: localhost:27017.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To start a new server instance on the default location use the following command on your shell.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"$ mkdir db\n\n$ mongod --dbpath ./db --smallfiles","category":"page"},{"location":"tutorial/#Connecting-to-MongoDB-1","page":"Tutorial","title":"Connecting to MongoDB","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Connect to a MongoDB instance using a Mongoc.Client. Use the MongoDB URI format to set the server location.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> import Mongoc\n\njulia> client = Mongoc.Client(\"mongodb://localhost:27017\")\nClient(URI(\"mongodb://localhost:27017\"))","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"As a shorthand, you can also use:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> client = Mongoc.Client(\"localhost\", 27017)","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To connect to the server at the default location localhost:27017 you can use the Mongoc.Client constructor with no arguments.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> client = Mongoc.Client()","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"One thing to keep in mind about MongoDB is that operations are usually lazy. So you don't actually connect to the database until you need to issue a command or query.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"If you need to check the connection status before sending commands, use Mongoc.ping(client) to ping the server.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> Mongoc.ping(client)\nBSON(\"{ \"ok\" : 1.0 }\")","category":"page"},{"location":"tutorial/#Getting-a-Database-1","page":"Tutorial","title":"Getting a Database","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"A MongoDB instance consists on a set of independent databases. You get a Database reference using the following command.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> database = client[\"my-database\"]\nDatabase(Client(URI(\"mongodb://localhost:27017\")), \"my-database\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"If \"my-database\" does not exist on your MongoDB instance, it will be created in the first time you insert a document in it.","category":"page"},{"location":"tutorial/#Getting-a-Collection-1","page":"Tutorial","title":"Getting a Collection","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"A Collection is a set of documents in a MongoDB database. You get a collection reference using the following command.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> collection = database[\"my-collection\"]\nCollection(Database(Client(URI(\"mongodb://localhost:27017\")), \"my-database\"), \"my-collection\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"If it does not exist inside your database, the Collection is created in the first time you insert a document in it.","category":"page"},{"location":"tutorial/#BSON-Documents-1","page":"Tutorial","title":"BSON Documents","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"BSON is the document format for MongoDB.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To create a BSON document instance in Mongoc.jl just use Dictionary syntax, using Strings as keys.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> document = Mongoc.BSON()\n\njulia> document[\"name\"] = \"Felipe\"\n\njulia> document[\"age\"] = 35\n\njulia> document[\"preferences\"] = [ \"Music\", \"Computer\", \"Photography\" ]\n\njulia> document[\"null_value\"] = nothing # maps to BSON null value\n\njulia> using Dates; document[\"details\"] = Dict(\"birth date\" => DateTime(1983, 4, 16), \"location\" => \"Rio de Janeiro\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"As another example:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> document = Mongoc.BSON(\"a\" => 1, \"b\" => \"field_b\", \"c\" => [1, 2, 3])\nBSON(\"{ \"a\" : 1, \"b\" : \"field_b\", \"c\" : [ 1, 2, 3 ] }\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"You can also create a BSON document from a JSON string.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> document = Mongoc.BSON(\"\"\"{ \"hey\" : \"you\" }\"\"\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"And also from a Dictionary.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> dict = Dict(\"hey\" => \"you\")\nDict{String,String} with 1 entry:\n  \"hey\" => \"you\"\n\njulia> document = Mongoc.BSON(dict)\nBSON(\"{ \"hey\" : \"you\" }\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Reading data from a BSON is like reading from a Dict.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> document = Mongoc.BSON(\"a\" => 1, \"b\" => \"field_b\", \"c\" => [1, 2, 3])\nBSON(\"{ \"a\" : 1, \"b\" : \"field_b\", \"c\" : [ 1, 2, 3 ] }\")\n\njulia> document[\"a\"]\n1\n\njulia> document[\"b\"]\n\"field_b\"","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Like a Dict, you can iterate thru BSON's (key, value) pairs, like so:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> for (k, v) in document\n           println(\"[$k] = $v\")\n       end\n[a] = 1\n[b] = field_b\n[c] = Any[1, 2, 3]","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To convert a BSON to a JSON string, use:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> Mongoc.as_json(document)\n\"{ \\\"name\\\" : \\\"Felipe\\\", \\\"age\\\" : 35, \\\"preferences\\\" : [ \\\"Music\\\", \\\"Computer\\\", \\\"Photography\\\" ], \\\"null_value\\\" : null, \\\"details\\\" : { \\\"location\\\" : \\\"Rio de Janeiro\\\", \\\"birth date\\\" : { \\\"\\$date\\\" : \\\"1983-04-16T00:00:00Z\\\" } } }\"","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To convert a BSON document to a Dictionary, use Mongoc.as_dict.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> Mongoc.as_dict(document)\nDict{Any,Any} with 1 entry:\n  \"hey\" => \"you\"","category":"page"},{"location":"tutorial/#Read/Write-BSON-documents-from/to-IO-Stream-1","page":"Tutorial","title":"Read/Write BSON documents from/to IO Stream","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"You can read and write BSON documents in binary format to IO streams.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"The following shows how to:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Create a vector of BSON documents.\nSave the vector to a file.\nRead back the vector of BSON documents from a file.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"using Test\n\nfilepath = \"data.bson\"\nlist = Vector{Mongoc.BSON}()\n\nlet\n    src = Mongoc.BSON()\n    src[\"id\"] = 1\n    src[\"name\"] = \"1st\"\n    push!(list, src)\nend\n\nlet\n    src = Mongoc.BSON()\n    src[\"id\"] = 2\n    src[\"name\"] = \"2nd\"\n    push!(list, src)\nend\n\nopen(filepath, \"w\") do io\n    Mongoc.write_bson(io, list)\nend\n\nlist_from_file = Mongoc.read_bson(filepath)\n@test length(list_from_file) == 2\n\nlet\n    fst_bson = list_from_file[1]\n    @test fst_bson[\"id\"] == 1\n    @test fst_bson[\"name\"] == \"1st\"\nend\n\nlet\n    sec_bson = list_from_file[2]\n    @test sec_bson[\"id\"] == 2\n    @test sec_bson[\"name\"] == \"2nd\"\nend","category":"page"},{"location":"tutorial/#Inserting-Documents-1","page":"Tutorial","title":"Inserting Documents","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To insert a single document into a collection, just Base.push! a BSON document to it. The result of this operation wraps the server reply and the inserted oid.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> document = Mongoc.BSON(\"\"\"{ \"hey\" : \"you\" }\"\"\")\nBSON(\"{ \"hey\" : \"you\" }\")\n\njulia> result = push!(collection, document)\nMongoc.InsertOneResult{Mongoc.BSONObjectId}(BSON(\"{ \"insertedCount\" : 1 }\"), BSONObjectId(\"5c9fdb5d11c3dd04a83ba6c2\"))\n\njulia> result.inserted_oid\nBSONObjectId(\"5c9fdb5d11c3dd04a83ba6c2\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Use Base.append! to insert a vector of documents to a collection. The result of this operation also wraps the server reply and the inserted oids.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> doc1 = Mongoc.BSON(\"\"\"{ \"hey\" : \"you\", \"out\" : \"there\" }\"\"\")\nBSON(\"{ \"hey\" : \"you\", \"out\" : \"there\" }\")\n\njulia> doc2 = Mongoc.BSON(\"\"\"{ \"hey\" : \"others\", \"in the\" : \"cold\" }\"\"\")\nBSON(\"{ \"hey\" : \"others\", \"in the\" : \"cold\" }\")\n\njulia> vector = [ doc1, doc2 ]\n2-element Array{Mongoc.BSON,1}:\n BSON(\"{ \"hey\" : \"you\", \"out\" : \"there\" }\")\n BSON(\"{ \"hey\" : \"others\", \"in the\" : \"cold\" }\")\n\njulia> append!(collection, vector)\nMongoc.BulkOperationResult{Union{Nothing, BSONObjectId}}(BSON(\"{ \"nInserted\" : 2, \"nMatched\" : 0, \"nModified\" : 0, \"nRemoved\" : 0, \"nUpserted\" : 0, \"writeErrors\" : [  ] }\"), 0x00000001, Union{Nothing, BSONObjectId}[BSONObjectId(\"5c9fdbab11c3dd04a83ba6c3\"), BSONObjectId(\"5c9fdbab11c3dd04a83ba6c4\")])","category":"page"},{"location":"tutorial/#Querying-Documents-1","page":"Tutorial","title":"Querying Documents","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To query a single document, use Mongoc.find_one. Pass a BSON argument as a query filter.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> document = Mongoc.find_one(collection, Mongoc.BSON(\"\"\"{ \"hey\" : \"you\" }\"\"\"))\nBSON(\"{ \"_id\" : { \"$oid\" : \"5b9ef9cc11c3dd1da14675c3\" }, \"hey\" : \"you\" }\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To iterate all documents from a collection, just use a for loop on a collection.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> for document in collection\n        println(document)\n       end\nBSON(\"{ \"_id\" : { \"$oid\" : \"5b9f02fb11c3dd1f4f3e26e5\" }, \"hey\" : \"you\", \"out\" : \"there\" }\")\nBSON(\"{ \"_id\" : { \"$oid\" : \"5b9f02fb11c3dd1f4f3e26e6\" }, \"hey\" : \"others\", \"in the\" : \"cold\" }\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To query multiple documents, use Mongoc.find. Pass a BSON query argument as a query filter. It returns a iterator of BSON documents that can be read using a for loop.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> for document in Mongoc.find(collection, Mongoc.BSON(\"\"\"{ \"in the\" : \"cold\" }\"\"\"))\n           println(document)\n       end\nBSON(\"{ \"_id\" : { \"$oid\" : \"5b9f02fb11c3dd1f4f3e26e6\" }, \"hey\" : \"others\", \"in the\" : \"cold\" }\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Use Base.collect to convert the result of Mongoc.find into a vector of BSON documents.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Also, applying Base.collect to a Collection gathers all documents in the collection.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> collect(collection)\n2-element Array{Mongoc.BSON,1}:\nBSON(\"{ \"_id\" : { \"$oid\" : \"5b9f02fb11c3dd1f4f3e26e5\" }, \"hey\" : \"you\", \"out\" : \"there\" }\")\nBSON(\"{ \"_id\" : { \"$oid\" : \"5b9f02fb11c3dd1f4f3e26e6\" }, \"hey\" : \"others\", \"in the\" : \"cold\" }\")","category":"page"},{"location":"tutorial/#Project-fields-to-Return-from-Query-1","page":"Tutorial","title":"Project fields to Return from Query","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"To select which fields you want a query to return, use a projection command in the options argument of Mongoc.find or Mongoc.find_one.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"As an example:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"function find_contract_codes(collection, criteria::Dict=Dict()) :: Vector{String}\n    result = Vector{String}()\n\n    let\n        bson_filter = Mongoc.BSON(criteria)\n        bson_options = Mongoc.BSON(\"\"\"{ \"projection\" : { \"_id\" : true }, \"sort\" : { \"_id\" : 1 } }\"\"\")\n        for bson_document in Mongoc.find(collection, bson_filter, options=bson_options)\n            push!(result, bson_document[\"_id\"])\n        end\n    end\n\n    return result\nend","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Check the libmongoc documentation for options field for details.","category":"page"},{"location":"tutorial/#Counting-Documents-1","page":"Tutorial","title":"Counting Documents","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Use Base.length function to count the number of documents in a collection. Pass a BSON argument as a query filter.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"julia> length(collection)\n2\n\njulia> length(collection, Mongoc.BSON(\"\"\"{ \"in the\" : \"cold\" }\"\"\"))\n1","category":"page"},{"location":"tutorial/#Aggregation-and-Map-Reduce-1","page":"Tutorial","title":"Aggregation and Map-Reduce","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Use Mongoc.aggregate to execute an aggregation command.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"The following reproduces the example from the MongoDB Tutorial.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"docs = [\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 500, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 250, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"B212\", \"amount\" : 200, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 300, \"status\" : \"D\" }\"\"\")\n]\n\ncollection = client[\"my-database\"][\"aggregation-collection\"]\nappend!(collection, docs)\n\n# Sets the pipeline command\nbson_pipeline = Mongoc.BSON(\"\"\"\n    [\n        { \"\\$match\" : { \"status\" : \"A\" } },\n        { \"\\$group\" : { \"_id\" : \"\\$cust_id\", \"total\" : { \"\\$sum\" : \"\\$amount\" } } }\n    ]\n\"\"\")\n\nfor doc in Mongoc.aggregate(collection, bson_pipeline)\n  println(doc)\nend","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"The result of the script above is:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"BSON(\"{ \"_id\" : \"B212\", \"total\" : 200 }\")\nBSON(\"{ \"_id\" : \"A123\", \"total\" : 750 }\")","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"A Map-Reduce operation can be executed with Mongoc.command_simple.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"input_collection_name = \"aggregation-collection\"\noutput_collection_name = \"order_totals\"\nquery = Mongoc.BSON(\"\"\"{ \"status\" : \"A\" }\"\"\")\n\n# use `Mongoc.BSONCode` to represent JavaScript elements in BSON\nmapper = Mongoc.BSONCode(\"\"\" function() { emit( this.cust_id, this.amount ); } \"\"\")\nreducer = Mongoc.BSONCode(\"\"\" function(key, values) { return Array.sum( values ) } \"\"\")\n\nmap_reduce_command = Mongoc.BSON()\nmap_reduce_command[\"mapReduce\"] = input_collection_name\nmap_reduce_command[\"map\"] = mapper\nmap_reduce_command[\"reduce\"] = reducer\nmap_reduce_command[\"out\"] = output_collection_name\nmap_reduce_command[\"query\"] = query\n\nresult = Mongoc.command_simple(database, map_reduce_command)\nprintln(result)\n\nfor doc in Mongoc.find(database[\"order_totals\"])\n   println(doc)\nend","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"The result of the script above is:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"BSON(\"{ \"result\" : \"order_totals\", \"timeMillis\" : 135, \"counts\" : { \"input\" : 3, \"emit\" : 3, \"reduce\" : 1, \"output\" : 2 }, \"ok\" : 1.0 }\")\nBSON(\"{ \"_id\" : \"A123\", \"value\" : 750.0 }\")\nBSON(\"{ \"_id\" : \"B212\", \"value\" : 200.0 }\")","category":"page"},{"location":"tutorial/#\"distinct\"-command-1","page":"Tutorial","title":"\"distinct\" command","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"This example demonstrates the distinct command, based on libmongoc docs.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"import Mongoc\nclient = Mongoc.Client()\n\ndocs = [\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 500, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 250, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"B212\", \"amount\" : 200, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 300, \"status\" : \"D\" }\"\"\")\n]\n\ncollection = client[\"my-database\"][\"my-collection\"]\nappend!(collection, docs)\n\ndistinct_cmd = Mongoc.BSON()\ndistinct_cmd[\"distinct\"] = \"my-collection\"\ndistinct_cmd[\"key\"] = \"status\"\n\nresult = Mongoc.command_simple(client[\"my-database\"], distinct_cmd)","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Which yields:","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"BSON(\"{ \"values\" : [ \"A\", \"D\" ], \"ok\" : 1.0 }\")","category":"page"},{"location":"tutorial/#Find-and-Modify-1","page":"Tutorial","title":"Find and Modify","text":"","category":"section"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"Use Mongoc.find_and_modify to query and update documents in a single pass.","category":"page"},{"location":"tutorial/#","page":"Tutorial","title":"Tutorial","text":"collection = client[\"db_name\"][\"find_and_modify\"]\n\ndocs = [\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 500, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 250, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"B212\", \"amount\" : 200, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 300, \"status\" : \"D\" }\"\"\")\n]\n\nappend!(collection, docs)\n\nMongoc.find_and_modify(\n    collection,\n    Mongoc.BSON(\"amount\" => 500),\n    update = Mongoc.BSON(\"\"\"{ \"\\$set\" : { \"status\" : \"N\" } }\"\"\")\n)\n\nmodified_doc = Mongoc.find_one(collection, Mongoc.BSON(\"amount\" => 500))\n@test modified_doc[\"status\"] == \"N\"","category":"page"},{"location":"crud/#CRUD-Operations-1","page":"CRUD Operations","title":"CRUD Operations","text":"","category":"section"},{"location":"crud/#Insert-1","page":"CRUD Operations","title":"Insert","text":"","category":"section"},{"location":"crud/#API-1","page":"CRUD Operations","title":"API","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"Mongoc.insert_one(collection::Collection, document::BSON; options::Union{Nothing, BSON}=nothing)\n\nMongoc.insert_many(collection::Collection, documents::Vector{BSON}; bulk_options::Union{Nothing, BSON}=nothing, insert_options::Union{Nothing, BSON}=nothing)","category":"page"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"Mongoc.insert_one is equivalent to Base.push! for a collection. The same applies to Mongoc.insert_many in relation to Base.append!.","category":"page"},{"location":"crud/#Examples-1","page":"CRUD Operations","title":"Examples","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"push!(collection, Mongoc.BSON(\"\"\"{ \"hello\" : \"world\" }\"\"\"))\n\nappend!(collection, [ Mongoc.BSON(\"\"\"{ \"first\" : 1, \"delete\" : true }\"\"\"), Mongoc.BSON(\"\"\"{ \"second\" : 2, \"delete\" : true }\"\"\"), Mongoc.BSON(\"\"\"{ \"third\" : 3, \"delete\" : false }\"\"\") ])","category":"page"},{"location":"crud/#Select-1","page":"CRUD Operations","title":"Select","text":"","category":"section"},{"location":"crud/#API-2","page":"CRUD Operations","title":"API","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"find_one(collection::Collection, bson_filter::BSON=BSON(); options::Union{Nothing, BSON}=nothing) :: Union{Nothing, BSON}\n\nfind(collection::Collection, bson_filter::BSON=BSON(); options::Union{Nothing, BSON}=nothing) :: Cursor","category":"page"},{"location":"crud/#Examples-2","page":"CRUD Operations","title":"Examples","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"bson = Mongoc.find_one(collection, Mongoc.BSON(\"\"\"{ \"third\" : 3 }\"\"\"))\n\nfor doc in Mongoc.find(collection)\n    println(doc)\nend","category":"page"},{"location":"crud/#Update-1","page":"CRUD Operations","title":"Update","text":"","category":"section"},{"location":"crud/#API-3","page":"CRUD Operations","title":"API","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"Mongoc.update_one(collection::Collection, selector::BSON, update::BSON; options::Union{Nothing, BSON}=nothing)\n\nMongoc.update_many(collection::Collection, selector::BSON, update::BSON; options::Union{Nothing, BSON}=nothing)","category":"page"},{"location":"crud/#Examples-3","page":"CRUD Operations","title":"Examples","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"selector = Mongoc.BSON(\"\"\"{ \"delete\" : false }\"\"\")\nupdate = Mongoc.BSON(\"\"\"{ \"\\$set\" : { \"delete\" : true, \"new_field\" : 1 } }\"\"\")\nMongoc.update_one(collection, selector, update)\n\nselector = Mongoc.BSON(\"\"\"{ \"delete\" : true }\"\"\")\nupdate = Mongoc.BSON(\"\"\"{ \"\\$set\" : { \"delete\" : false } }\"\"\")\nMongoc.update_many(collection, selector, update)","category":"page"},{"location":"crud/#Delete-1","page":"CRUD Operations","title":"Delete","text":"","category":"section"},{"location":"crud/#API-4","page":"CRUD Operations","title":"API","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"Mongoc.delete_one(collection::Collection, selector::BSON; options::Union{Nothing, BSON}=nothing)\n\nMongoc.delete_many(collection::Collection, selector::BSON; options::Union{Nothing, BSON}=nothing)","category":"page"},{"location":"crud/#Examples-4","page":"CRUD Operations","title":"Examples","text":"","category":"section"},{"location":"crud/#","page":"CRUD Operations","title":"CRUD Operations","text":"selector = Mongoc.BSON(\"_id\" => oid)\nMongoc.delete_one(collection, selector)\n\n# deletes all elements in a collection\nMongoc.delete_many(collection, Mongoc.BSON()) # equivalent to `empty!(collection)`","category":"page"},{"location":"authentication/#Authentication-1","page":"Authentication","title":"Authentication","text":"","category":"section"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"Refer to the Security section of the MongoDB Manual for an overview on how authentication works in MongoDB.","category":"page"},{"location":"authentication/#Basic-Authentication-(SCRAM)-1","page":"Authentication","title":"Basic Authentication (SCRAM)","text":"","category":"section"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"In this authentication mechanism, user and passwords are passed in the URI string for the Mongoc.Client.","category":"page"},{"location":"authentication/#Enable-Auth-1","page":"Authentication","title":"Enable Auth","text":"","category":"section"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"To use basic authentication mechanism, first enable authentication in the database, as described in the MongoDB manual.","category":"page"},{"location":"authentication/#.-Start-MongoDB-without-access-control-1","page":"Authentication","title":"1. Start MongoDB without access control","text":"","category":"section"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"$ mongod --dbpath ./db","category":"page"},{"location":"authentication/#.-Connect-to-the-database-and-create-an-admin-user.-1","page":"Authentication","title":"2. Connect to the database and create an admin user.","text":"","category":"section"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"From a Julia session, you can use Mongoc.add_user to add users to a MongoDB database.","category":"page"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"import Mongoc\nroles = Mongoc.BSON(\"\"\"[ { \"role\" : \"userAdminAnyDatabase\", \"db\" : \"admin\" }, \"readWriteAnyDatabase\" ]\"\"\")\nclient = Mongoc.Client()\nMongoc.add_user(client[\"admin\"], \"myUserAdmin\", \"abc123\", roles)\nMongoc.destroy!(client) # or exit julia session","category":"page"},{"location":"authentication/#.-Re-start-the-MongoDB-instance-with-access-control-1","page":"Authentication","title":"3. Re-start the MongoDB instance with access control","text":"","category":"section"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"Kill the previous process running mongod and then start server with auth option.","category":"page"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"$ mongod --auth --dbpath ./db","category":"page"},{"location":"authentication/#Connect-and-authenticate-1","page":"Authentication","title":"Connect and authenticate","text":"","category":"section"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"Pass the user and password in the URI, as described in http://mongoc.org/libmongoc/current/authentication.html.","category":"page"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"client = Mongoc.Client(\"mongodb://myUserAdmin:abc123@localhost/?authSource=admin\")","category":"page"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"From MongoDB 4.0, there's a new authentication mechanism SCRAM-SHA-256, which replaces the previous SCRAM-SHA-1 mechanism. The correct authentication mechanism is negotiated between the driver and the server.","category":"page"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"Alternatively, SCRAM-SHA-256 can be explicitly specified:","category":"page"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"client = Mongoc.Client(\"mongodb://myUserAdmin:abc123@localhost/?authMechanism=SCRAM-SHA-256&authSource=admin\")","category":"page"},{"location":"authentication/#","page":"Authentication","title":"Authentication","text":"Refer to the MongoDB manual for adding new users and roles per database.","category":"page"},{"location":"transaction/#Transactions-1","page":"Transactions","title":"Transactions","text":"","category":"section"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"Support for transactions is available from MongoDB v4.0.","category":"page"},{"location":"transaction/#Setting-up-a-Replica-Set-1","page":"Transactions","title":"Setting up a Replica Set","text":"","category":"section"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"As described in the MongoDB Manual, \"multi-document transactions are available for replica sets only. Transactions for sharded clusters are scheduled for MongoDB 4.2\".","category":"page"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"Follow these steps to start a replica set.","category":"page"},{"location":"transaction/#Executing-Transactions-1","page":"Transactions","title":"Executing Transactions","text":"","category":"section"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"In MongoDB, transactions are bound to Sessions.","category":"page"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"In Mongoc.jl, use the function Mongoc.transaction with do-syntax to execute a transaction, and use the argument session to get database and collection references bound to the session that will execute the transaction.","category":"page"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"Just use the session object the same way you would use a Client.","category":"page"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"note: Note\nDatabase and Collection references that are not created from a session object are not bound to the transaction.","category":"page"},{"location":"transaction/#Example-1","page":"Transactions","title":"Example","text":"","category":"section"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"import Mongoc\n\n# connect to a Replica Set\nclient = Mongoc.Client(\"mongodb://127.0.0.1:27021,127.0.0.1:27022,127.0.0.1:27023/?replicaSet=rs0\")\n\n# this collection reference is not bounded to the transaction\ncollection_unbounded = client[\"my_database\"][\"my_collection\"]\n\n# insert a dummy document, just to make sure the collection exists\npush!(collection_unbounded, Mongoc.BSON(\"\"\"{ \"test\" : 1 }\"\"\"))\nempty!(collection_unbounded)\n\nMongoc.transaction(client) do session\n    database = session[\"my_database\"]\n    collection = database[\"my_collection\"]\n    new_item = Mongoc.BSON()\n    new_item[\"inserted\"] = true\n    push!(collection, new_item)\n    println(\"collection_bounded is empty? \", isempty(collection_unbounded))\n    println(\"collection is empty? \", isempty(collection))\nend\n\nprintln(collect(collection_unbounded))","category":"page"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"The script output is:","category":"page"},{"location":"transaction/#","page":"Transactions","title":"Transactions","text":"collection_bounded is empty? true\ncollection is empty? false\nMongoc.BSON[BSON(\"{ \"_id\" : { \"$oid\" : \"5ba4251f3192e3298b62c5a3\" }, \"inserted\" : true }\")]","category":"page"},{"location":"api/#API-Reference-1","page":"API Reference","title":"API Reference","text":"","category":"section"},{"location":"api/#BSON-1","page":"API Reference","title":"BSON","text":"","category":"section"},{"location":"api/#","page":"API Reference","title":"API Reference","text":"Mongoc.BSON\nMongoc.BSONObjectId\nMongoc.BSONCode\nMongoc.as_json\nMongoc.as_dict\nMongoc.read_bson\nMongoc.write_bson\nMongoc.read_next_bson\nMongoc.BSONError","category":"page"},{"location":"api/#Mongoc.BSON","page":"API Reference","title":"Mongoc.BSON","text":"A BSON represents a document in Binary JSON format, defined at http://bsonspec.org/.\n\nIn Julia, you can manipulate a BSON instance just like a Dict.\n\nExample\n\nbson = Mongoc.BSON()\nbson[\"name\"] = \"my name\"\nbson[\"num\"] = 10.0\n\nC API\n\nBSON is a wrapper for C struct bson_t.\n\n\n\n\n\n","category":"type"},{"location":"api/#Mongoc.BSONObjectId","page":"API Reference","title":"Mongoc.BSONObjectId","text":"A BSONObjectId represents a unique identifier for a BSON document.\n\nExample\n\nThe following generates a new BSONObjectId.\n\njulia> Mongoc.BSONObjectId()\n\nC API\n\nBSONObjectId instances addresses are passed to libbson/libmongoc API using Ref(oid), and are owned by the Julia process.\n\nMirrors C struct bson_oid_t:\n\ntypedef struct {\n   uint8_t bytes[12];\n} bson_oid_t;\n\n\n\n\n\n","category":"type"},{"location":"api/#Mongoc.BSONCode","page":"API Reference","title":"Mongoc.BSONCode","text":"BSONCode is a BSON element with JavaScript source code.\n\nExample\n\njulia> bson = Mongoc.BSON(\"source\" => Mongoc.BSONCode(\"function() = 1\"))\nBSON(\"{ \"source\" : { \"$code\" : \"function() = 1\" } }\")\n\n\n\n\n\n","category":"type"},{"location":"api/#Mongoc.as_json","page":"API Reference","title":"Mongoc.as_json","text":"as_json(bson::BSON; canonical::Bool=false) :: String\n\nConverts a bson object to a JSON string.\n\nExample\n\njulia> document = Mongoc.BSON(\"{ \"hey\" : 1 }\")\nBSON(\"{ \"hey\" : 1 }\")\n\njulia> Mongoc.as_json(document)\n\"{ \"hey\" : 1 }\"\n\njulia> Mongoc.as_json(document, canonical=true)\n\"{ \"hey\" : { \"$numberInt\" : \"1\" } }\"\n\nC API\n\nbson_as_canonical_extended_json\nbson_as_relaxed_extended_json\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.as_dict","page":"API Reference","title":"Mongoc.as_dict","text":"as_dict(document::BSON) :: Dict\n\nConverts a BSON document to a Julia Dict.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.read_bson","page":"API Reference","title":"Mongoc.read_bson","text":"read_bson(io::IO) :: Vector{BSON}\n\nReads all BSON documents from io. This method will continue to read from io until it reaches eof.\n\n\n\n\n\nread_bson(data::Vector{UInt8}) :: Vector{BSON}\n\nParses a vector of bytes to a vector of BSON documents. Useful when reading BSON as binary from a stream.\n\n\n\n\n\nread_bson(filepath::AbstractString) :: Vector{BSON}\n\nReads all BSON documents from a file located at filepath.\n\nThis will open a Mongoc.BSONReader pointing to the file and will parse file contents to BSON documents.\n\n\n\n\n\nread_bson(reader::BSONReader) :: Vector{BSON}\n\nReads all BSON documents from a reader.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.write_bson","page":"API Reference","title":"Mongoc.write_bson","text":"write_bson(io::IO, bson::BSON;\n    initial_buffer_capacity::Integer=DEFAULT_BSON_WRITER_BUFFER_CAPACITY)\n\nWrites a single BSON document to io in binary format.\n\n\n\n\n\nwrite_bson(io::IO, bson_list::Vector{BSON};\n    initial_buffer_capacity::Integer=DEFAULT_BSON_WRITER_BUFFER_CAPACITY)\n\nWrites a vector of BSON documents to io in binary format.\n\nExample\n\nlist = Vector{Mongoc.BSON}()\n\nlet\n    src = Mongoc.BSON()\n    src[\"id\"] = 1\n    src[\"name\"] = \"1st\"\n    push!(list, src)\nend\n\nlet\n    src = Mongoc.BSON()\n    src[\"id\"] = 2\n    src[\"name\"] = \"2nd\"\n    push!(list, src)\nend\n\nopen(\"documents.bson\", \"w\") do io\n    Mongoc.write_bson(io, list)\nend\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.read_next_bson","page":"API Reference","title":"Mongoc.read_next_bson","text":"read_next_bson(reader::BSONReader) :: Union{Nothing, BSON}\n\nReads the next BSON document available in the stream pointed by reader. Returns nothing if reached the end of the stream.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.BSONError","page":"API Reference","title":"Mongoc.BSONError","text":"BSONError is the default Exception for BSON/MongoDB function call errors.\n\nC API\n\nMirrors C struct bson_error_t.\n\nBSONError instances addresses are passed to libbson/libmongoc API using Ref(error), and are owned by the Julia process.\n\ntypedef struct {\n   uint32_t domain;\n   uint32_t code;\n   char message[504];\n} bson_error_t;\n\n\n\n\n\n","category":"type"},{"location":"api/#Client-1","page":"API Reference","title":"Client","text":"","category":"section"},{"location":"api/#","page":"API Reference","title":"API Reference","text":"Mongoc.Client\nMongoc.set_appname!\nMongoc.ping\nMongoc.get_server_mongodb_version\nMongoc.find_databases\nMongoc.get_database_names\nMongoc.has_database","category":"page"},{"location":"api/#Mongoc.Client","page":"API Reference","title":"Mongoc.Client","text":"Client(host, port)\nClient(uri)\nClient()\n\nCreates a Client, which represents a connection to a MongoDB database.\n\nExamples:\n\nThese lines are equivalent.\n\nc = Mongoc.Client()\nc = Mongoc.Client(\"localhost\", 27017)\nc = Mongoc.Client(\"mongodb://localhost:27017\")\n\n\n\n\n\n","category":"type"},{"location":"api/#Mongoc.set_appname!","page":"API Reference","title":"Mongoc.set_appname!","text":"set_appname!(client::Client, appname::String)\n\nSets the application name for this client.\n\nThis string, along with other internal driver details, is sent to the server as part of the initial connection handshake.\n\nC API\n\nmongoc_client_set_appname.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.ping","page":"API Reference","title":"Mongoc.ping","text":"ping(client::Client) :: BSON\n\nPings the server, testing wether it is reachable.\n\nOne thing to keep in mind is that operations on MongoDB are lazy, which means that a client reaches a server only when it needs to transfer documents.\n\nExample\n\njulia> client = Mongoc.Client() # nothing happens here between client and server\nClient(URI(\"mongodb://localhost:27017\"))\n\njulia> Mongoc.ping(client) # connection to server happens here\nBSON(\"{ \"ok\" : 1.0 }\")\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.get_server_mongodb_version","page":"API Reference","title":"Mongoc.get_server_mongodb_version","text":"get_server_mongodb_version(client::Client) :: VersionNumber\n\nQueries the version for the MongoDB server instance.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.find_databases","page":"API Reference","title":"Mongoc.find_databases","text":"find_databases(client::Client; options::Union{Nothing, BSON}=nothing) :: Cursor\n\nQueries for databases.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.get_database_names","page":"API Reference","title":"Mongoc.get_database_names","text":"get_database_names(client::Client; options::Union{Nothing, BSON}=nothing) :: Vector{String}\n\nHelper method to get a list of names for all databases.\n\nSee also Mongoc.find_databases.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.has_database","page":"API Reference","title":"Mongoc.has_database","text":"has_database(client::Client, database_name::String;\n    options::Union{Nothing, BSON}=nothing) :: Bool\n\nHelper method to check if there is a database named database_name.\n\nSee also Mongoc.find_databases.\n\n\n\n\n\n","category":"function"},{"location":"api/#Database-1","page":"API Reference","title":"Database","text":"","category":"section"},{"location":"api/#","page":"API Reference","title":"API Reference","text":"Mongoc.command_simple\nMongoc.add_user\nMongoc.remove_user\nMongoc.has_user\nMongoc.find_collections\nMongoc.get_collection_names","category":"page"},{"location":"api/#Mongoc.command_simple","page":"API Reference","title":"Mongoc.command_simple","text":"command_simple(database::Database, command::BSON) :: BSON\ncommand_simple(collection::Collection, command::BSON) :: BSON\n\nExecutes a command given by a JSON string or a BSON instance.\n\nIt returns the first document from the result cursor.\n\nExample\n\njulia> client = Mongoc.Client() # connects to localhost at port 27017\nClient(URI(\"mongodb://localhost:27017\"))\n\njulia> bson_result = Mongoc.command_simple(client[\"admin\"], \"{ \"ping\" : 1 }\")\nBSON(\"{ \"ok\" : 1.0 }\")\n\nC API\n\nmongoc_database_command_simple\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.add_user","page":"API Reference","title":"Mongoc.add_user","text":"add_user(database::Database, username::String, password::String, roles::Union{Nothing, BSON},\n    custom_data::Union{Nothing, BSON}=nothing)\n\nThis function shall create a new user with access to database.\n\nWarning: Do not call this function without TLS.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.remove_user","page":"API Reference","title":"Mongoc.remove_user","text":"remove_user(database::Database, username::String)\n\nRemoves a user from database.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.has_user","page":"API Reference","title":"Mongoc.has_user","text":"has_user(database::Database, user_name::String) :: Bool\n\nChecks if database has a user named user_name.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.find_collections","page":"API Reference","title":"Mongoc.find_collections","text":"find_collections(database::Database; options::Union{Nothing, BSON}=nothing) :: Cursor\n\nQueries for collections in a database.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.get_collection_names","page":"API Reference","title":"Mongoc.get_collection_names","text":"get_collection_names(database::Database;\n    options::Union{Nothing, BSON}=nothing) :: Vector{String}\n\nHelper method to get collection names.\n\nSee also Mongoc.find_collections.\n\n\n\n\n\n","category":"function"},{"location":"api/#Collection-1","page":"API Reference","title":"Collection","text":"","category":"section"},{"location":"api/#","page":"API Reference","title":"API Reference","text":"Mongoc.find\nMongoc.find_one\nMongoc.count_documents\nMongoc.drop\nMongoc.find_and_modify\nMongoc.FindAndModifyFlags","category":"page"},{"location":"api/#Mongoc.find","page":"API Reference","title":"Mongoc.find","text":"find(collection::Collection, bson_filter::BSON=BSON();\n    options::Union{Nothing, BSON}=nothing) :: Cursor\n\nExecutes a query on collection and returns an iterable Cursor.\n\nExample\n\nfunction find_contract_codes(collection, criteria::Dict=Dict()) :: Vector{String}\n    result = Vector{String}()\n\n    let\n        bson_filter = Mongoc.BSON(criteria)\n        bson_options = Mongoc.BSON(\"\"\"{ \"projection\" : { \"_id\" : true }, \"sort\" : { \"_id\" : 1 } }\"\"\")\n        for bson_document in Mongoc.find(collection, bson_filter, options=bson_options)\n            push!(result, bson_document[\"_id\"])\n        end\n    end\n\n    return result\nend\n\nCheck the libmongoc documentation for more information.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.find_one","page":"API Reference","title":"Mongoc.find_one","text":"find_one(collection::Collection, bson_filter::BSON=BSON();\n    options::Union{Nothing, BSON}=nothing) :: Union{Nothing, BSON}\n\nExecute a query to a collection and returns the first element of the result set.\n\nReturns nothing if the result set is empty.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.count_documents","page":"API Reference","title":"Mongoc.count_documents","text":"count_documents(collection::Collection, bson_filter::BSON=BSON();\n    options::Union{Nothing, BSON}=nothing) :: Int\n\nReturns the number of documents on a collection, with an optional filter given by bson_filter.\n\nlength(collection) and Mongoc.count_documents(collection) produces the same output.\n\nExample\n\nresult = length(collection, Mongoc.BSON(\"_id\" => oid))\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.drop","page":"API Reference","title":"Mongoc.drop","text":"drop(database::Database, opts::Union{Nothing, BSON}=nothing)\ndrop(collection::Collection, opts::Union{Nothing, BSON}=nothing)\n\nDrops database or collection.\n\nFor information about opts argument, check the libmongoc documentation for database drop or collection drop.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.find_and_modify","page":"API Reference","title":"Mongoc.find_and_modify","text":"find_and_modify(collection::Collection, query::BSON;\n    update::Union{Nothing, BSON}=nothing,\n    sort::Union{Nothing, BSON}=nothing,\n    fields::Union{Nothing, BSON}=nothing,\n    bypass_document_validation::Bool=false,\n) :: BSON\n\nFind documents and updates them in one go.\n\nSee libmongoc documentation for examples.\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.FindAndModifyFlags","page":"API Reference","title":"Mongoc.FindAndModifyFlags","text":"Adds one or more flags to the FindAndModifyOptsBuilder.\n\nMONGOC_FIND_AND_MODIFY_NONE: Default. Doesnt add anything to the builder.\nMONGOC_FIND_AND_MODIFY_REMOVE: Will instruct findandmodify to remove the matching document.\nMONGOC_FIND_AND_MODIFY_UPSERT: Update the matching document or, if no document matches, insert the document.\nMONGOC_FIND_AND_MODIFY_RETURN_NEW: Return the resulting document.\n\n\n\n\n\n","category":"type"},{"location":"api/#Aggregation-1","page":"API Reference","title":"Aggregation","text":"","category":"section"},{"location":"api/#","page":"API Reference","title":"API Reference","text":"Mongoc.aggregate\nMongoc.QueryFlags","category":"page"},{"location":"api/#Mongoc.aggregate","page":"API Reference","title":"Mongoc.aggregate","text":"aggregate(collection::Collection, bson_pipeline::BSON;\n    flags::QueryFlags=QUERY_FLAG_NONE,\n    options::Union{Nothing, BSON}=nothing) :: Cursor\n\nUse Mongoc.aggregate to execute an aggregation command.\n\nExample\n\nThe following reproduces the example from the MongoDB Tutorial.\n\ndocs = [\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 500, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 250, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"B212\", \"amount\" : 200, \"status\" : \"A\" }\"\"\"),\n    Mongoc.BSON(\"\"\"{ \"cust_id\" : \"A123\", \"amount\" : 300, \"status\" : \"D\" }\"\"\")\n]\n\ncollection = client[\"my-database\"][\"aggregation-collection\"]\nappend!(collection, docs)\n\n# Sets the pipeline command\nbson_pipeline = Mongoc.BSON(\"\"\"\n    [\n        { \"$match\" : { \"status\" : \"A\" } },\n        { \"$group\" : { \"_id\" : \"$cust_id\", \"total\" : { \"$sum\" : \"$amount\" } } }\n    ]\n\"\"\")\n\nfor doc in Mongoc.aggregate(collection, bson_pipeline)\n  println(doc)\nend\n\nThe result of the script above is:\n\nBSON(\"{ \"_id\" : \"B212\", \"total\" : 200 }\")\nBSON(\"{ \"_id\" : \"A123\", \"total\" : 750 }\")\n\n\n\n\n\n","category":"function"},{"location":"api/#Mongoc.QueryFlags","page":"API Reference","title":"Mongoc.QueryFlags","text":"QueryFlags correspond to the MongoDB wire protocol. They may be bitwise ord together. They may modify how a query is performed in the MongoDB server.\n\nThese flags are passed as optional argument for the aggregation function Mongoc.aggregate.\n\nThis data type mirrors C struct mongoc_query_flags_t. See libmongoc docs for more information.\n\nConstants\n\nMongoc.QUERY_FLAG_NONE: Specify no query flags.\n\nMongoc.QUERY_FLAG_TAILABLE_CURSOR: Cursor will not be closed when the last data is retrieved. You can resume this cursor later.\n\nMongoc.QUERY_FLAG_SLAVE_OK: Allow query of replica set secondaries.\n\nMongoc.QUERY_FLAG_OPLOG_REPLAY: Used internally by MongoDB.\n\nMongoc.QUERY_FLAG_NO_CURSOR_TIMEOUT: The server normally times out an idle cursor after an inactivity period (10 minutes). This prevents that.\n\nMongoc.QUERY_FLAG_AWAIT_DATA: Use with Mongoc.MONGOC_QUERY_TAILABLE_CURSOR. Block rather than returning no data. After a period, time out.\n\nMongoc.QUERY_FLAG_EXHAUST: Stream the data down full blast in multiple \"reply\" packets. Faster when you are pulling down a lot of data and you know you want to retrieve it all.\n\nMongoc.QUERY_FLAG_PARTIAL: Get partial results from mongos if some shards are down (instead of throwing an error).\n\n\n\n\n\n","category":"type"},{"location":"api/#Session-1","page":"API Reference","title":"Session","text":"","category":"section"},{"location":"api/#","page":"API Reference","title":"API Reference","text":"Mongoc.transaction","category":"page"},{"location":"api/#Mongoc.transaction","page":"API Reference","title":"Mongoc.transaction","text":"transaction(f::Function, client::Client; session_options::SessionOptions=SessionOptions())\n\nUse do-syntax to execute a transaction.\n\nTransaction will be commited automatically. If an error occurs, the transaction is aborted.\n\nThe session parameter should be treated the same way as a Client: from a session you get a database, and a collection that are bound to the session.\n\nMongoc.transaction(client) do session\n    database = session[\"my_database\"]\n    collection = database[\"my_collection\"]\n    new_item = Mongoc.BSON()\n    new_item[\"inserted\"] = true\n    push!(collection, new_item)\nend\n\n\n\n\n\n","category":"function"}]
}
